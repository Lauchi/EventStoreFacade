version: '0.10.2'

branches:
  only:
  - release

dotnet_csproj:
  patch: true
  file: '**\*.csproj'
  version: '{version}'
  package_version: '{version}'
  assembly_version: '{version}'
  file_version: '{version}'
  informational_version: '{version}'

services:
  - mongodb

init:
  - git config --global core.autocrlf false

before_build:
  - appveyor-retry dotnet restore -v Minimal

environment:
  matrix:
    - APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2017

build_script:
  - dotnet build

test_script:
  - dotnet test

artifacts:
  - path: '**\*.nupkg'

deploy:
  provider: NuGet
  api_key:
    secure: iQy21wVmrNBeqZ8L8Hj0uGFuit3zWKggfRV6wzWyWrDTvp55gEyYPEQqssSz7V5T
  artifact: /.*\.nupkg/